#!/bin/bash -eu

Import PogoConfig
Import PogoFunctions
Import RecipeFunctions
Import BuildFunctions

InChroot && Fatal "don't call in chroot"

#verbose=''

token=${1:-}

[[ -n $token ]] || Fatal "no recipe token given"

BuildSetupRecipe $token

echo -ne "\033]0;BUILD $RecipeCollection / $Title\007"

BuildCreateBuildHead
MakeBootsRootfs $BuildChroot/Root

ProvideSupplies

ExecInBootsChroot "pogo compile $token"

pogo bharvest $token

BuildCleanBuildHead

echo DONE
