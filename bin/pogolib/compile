#!/bin/bash -eu

Import PogoConfig
Import PogoFunctions
Import RecipeFunctions
Import BuildFunctions

env

InChroot || Fatal "call in chroot only"

#verbose=''

Token=$1

BuildSetupRecipe $Token

BuildExec()
{
    local function=$1
    if [[ "$(type -t $function)" == "function" ]]; then
        $function
    else
        echo "NOP for $function"
    fi
}

BuildEnterMain && Prepare
BuildEnterBuildIn && Configure
BuildEnterBuildIn && Build
BuildEnterBuildIn && Install
BuildEnterBuildIn && Trim

